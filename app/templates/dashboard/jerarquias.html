{#Niveles de acceso#}

{% extends 'dashboard/index.html' %}

{% block title %}Jerarquias | Arkadex{% endblock %}

{% block dashboard_body %}

{#    Alertas de ventana#}

    {% block alertContainer %}

        <!-- Si existe una alerta específica para esta URL (alert_finish), la mostramos -->
        {% if alert_finish %}
            {% with icon=alert_finish.icon, title=alert_finish.title, subtitle=alert_finish.subtitle, btn_info=alert_finish.btn_info, modal_target='createJerarquiaModal'%}
                {% include 'components/alert-container.html' %}
            {% endwith %}
        {% endif %}

    {% endblock %}

    {% include 'components/header-section.html' %}

    <div class="jerarquia-container">
        {% block jerarquiaContainer %}
            {%  include 'components/general-card.html' %}
        {% endblock %}
    </div>

    {% include 'dashboard/jerarquias/create.html' %}
    {% include 'dashboard/jerarquias/update.html' %}
    {% include 'components/delete-modal.html' %}

    <script>
        function toggleModal(modalID) {
            const modal = document.getElementById(modalID);
            if (modal) {
                // Si usas display: none en CSS
                if (modal.style.display === "none" || modal.style.display === "") {
                    modal.style.display = "flex";
                } else {
                    modal.style.display = "none";
                }
                // O si usas una clase .active en tu CSS:
                // modal.classList.toggle('active');
            }
        }
{#
        function openUpdateModal(button) {
            // 1. Obtener datos del botón
            const id = button.getAttribute('data-id');
            const nombre = button.getAttribute('data-nombre');
            const especialidad = button.getAttribute('data-especialidad');
            const descripcion = button.getAttribute('data-descripcion');

            // 2. Construir la URL de actualización dinámicamente
            // Usamos un ID '0' temporal para que Flask genere la base de la URL, y luego lo reemplazamos
            const baseUrl = "{{ url_for('jerarquias.update', id_rol=0) }}";
            const updateUrl = baseUrl.replace('0', id);

            // 3. Asignar al formulario y a los inputs
            document.getElementById('formUpdateJerarquia').action = updateUrl;
            document.getElementById('inputNombreJerarquia').value = nombre;
            document.getElementById('inputEspecialidadJerarquia').value = especialidad;
            document.getElementById('inputDescripcionJerarquia').value = descripcion;

            // 4. Abrir el modal
            toggleModal('updateJerarquiaModal');
        }

        function openDeleteModal(deleteUrl, jerarquiaName) {
            // 1. Actualizar el enlace del botón de confirmación
            document.getElementById('btnConfirmPurge').href = deleteUrl;

            // 2. Mostrar el nombre del rol en la advertencia
            document.getElementById('deleteJerarquiaName').textContent = jerarquiaName;

            // 3. Abrir el modal
            toggleModal('deleteJerarquiaModal');
        }
        #}

    </script>


{% endblock %}